2025-11-21 18:58:48.110 WARNING streamlit.runtime.scriptrunner_utils.script_run_context: Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-11-21 18:58:48.118 WARNING streamlit.runtime.scriptrunner_utils.script_run_context: Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-11-21 18:58:48.306 
  [33m[1mWarning:[0m to view this Streamlit app on a browser, run it with the following
  command:

    streamlit run test_warehouse_scrap_export.py [ARGUMENTS]
2025-11-21 18:58:48.306 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-11-21 18:58:48.306 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-11-21 18:58:48.306 No runtime found, using MemoryCacheStorageManager
2025-11-21 18:58:48.314 No runtime found, using MemoryCacheStorageManager
2025-11-21 18:58:48.314 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-11-21 18:58:48.314 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-11-21 18:58:48.314 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-11-21 18:58:48.314 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-11-21 18:58:48.314 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-11-21 18:58:48.314 Session state does not function when running a script without `streamlit run`
2025-11-21 18:58:48.469 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-11-21 18:58:48.819 Thread 'Thread-1': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-11-21 18:58:48.819 Thread 'Thread-1': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-11-21 18:58:48.819 Thread 'Thread-1': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-11-21 18:58:52.606 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-11-21 18:59:04.271 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-11-21 18:59:05.828 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-11-21 18:59:05.828 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2025-11-21 18:59:05.828 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
C:\Users\603506\Desktop\Trevor_Python\POP_Supply_Chain\pages\inventory_page.py:389: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value '[1.00000000e+00 1.00000000e+01 0.00000000e+00 0.00000000e+00
 0.00000000e+00 9.00000000e+00 9.60000000e+01 5.20000000e+01
 0.00000000e+00 3.30000000e+01 4.87000000e+02 0.00000000e+00
 2.50000000e+01 1.90000000e+01 3.90000000e+01 2.60000000e+01
 9.00000000e+00 1.40000000e+01 0.00000000e+00 0.00000000e+00
 0.00000000e+00 1.40000000e+01 9.00000000e+01 2.00000000e+00
 8.00000000e+00 1.10000000e+02 5.00000000e+00 1.70000000e+01
 5.70000000e+01 1.44000000e+02 1.80000000e+01 1.00000000e+00
 3.00000000e+00 3.00000000e+00 3.00000000e+00 4.20000000e+01
 0.00000000e+00 2.40000000e+01 1.50000000e+01 0.00000000e+00
 0.00000000e+00 1.50000000e+02 3.80000000e+01 1.00000000e+01
 3.70000000e+01 2.30000000e+01 5.30000000e+01 5.10000000e+01
 5.50000000e+01 2.60000000e+01 1.60000000e+01 5.90000000e+01
 3.90000000e+01 0.00000000e+00 2.00000000e+00 7.10542736e-15
 3.70000000e+01 8.00000000e+00 5.00000000e+00 3.30000000e+01
 2.00000000e+01 5.00000000e+00 4.00000000e+01 3.60000000e+01
 3.00000000e+00 5.00000000e+00 6.00000000e+01 4.00000000e+00
 0.00000000e+00 2.00000000e+00 4.20000000e+01 1.60000000e+01
 0.00000000e+00 8.90000000e+01 8.00000000e+00 2.10000000e+01
 1.80000000e+01 1.02000000e+02 5.00000000e+00 2.20000000e+01
 0.00000000e+00 1.40000000e+01 8.00000000e+00 1.02000000e+02
 8.00000000e+00 7.90000000e+01 4.20000000e+01 1.40000000e+01
 2.10000000e+01 1.60000000e+01 7.00000000e+00 6.30000000e+01
 3.00000000e+00 9.00000000e+00 1.00000000e+00 4.44089210e-16
 4.40000000e+01 0.00000000e+00 5.07000000e+02 1.40000000e+01
 4.73000000e+02 6.58000000e+02 9.40000000e+01 2.70000000e+02
 4.20000000e+01 0.00000000e+00 2.20000000e+01 2.00000000e+01
 0.00000000e+00 1.28600000e+03 8.00000000e+00 0.00000000e+00
 0.00000000e+00 3.00000000e+00 0.00000000e+00 0.00000000e+00
 3.40000000e+01 0.00000000e+00 1.70000000e+01 5.00000000e+00
 1.80000000e+01 1.06000000e+02 1.02000000e+02 1.80000000e+01
 2.00000000e+01 1.48000000e+02 0.00000000e+00 1.00000000e+01
 1.00000000e+00 0.00000000e+00 1.00000000e+00 0.00000000e+00
 3.00000000e+00 2.00000000e+00 2.00000000e+00 6.00000000e+00
 9.00000000e+00 1.21000000e+02 1.00000000e+00 0.00000000e+00
 0.00000000e+00 1.80000000e+01 0.00000000e+00 4.44089210e-16]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  df.loc[conservative_mask, 'conservative_scrap_qty'] = df.loc[conservative_mask].apply(
C:\Users\603506\Desktop\Trevor_Python\POP_Supply_Chain\pages\inventory_page.py:406: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value '[1.90684932e+01 0.00000000e+00 3.90000000e+01 2.21589041e+02
 3.69278082e+03 4.50410959e+01 0.00000000e+00 5.40547945e+01
 1.59602740e+02 2.47589041e+02 7.35479452e+01 2.01369863e+00
 2.29178082e+01 0.00000000e+00 1.24219178e+02 4.09041096e+01
 0.00000000e+00 0.00000000e+00 1.12191781e+01 0.00000000e+00
 6.00000000e+01 3.21643836e+01 2.16301370e+01 0.00000000e+00
 3.25479452e+01 0.00000000e+00 6.00273973e+01 0.00000000e+00
 5.17808219e+00 0.00000000e+00 1.05068493e+01 1.01506849e+01
 0.00000000e+00 4.95753425e+01 5.50547945e+01 7.60273973e+00
 2.62739726e+01 3.27397260e+00 8.26027397e+00 5.03972603e+01
 1.07547945e+02 2.25013699e+02 1.58506849e+02 1.98506849e+02
 7.27397260e+00 6.26027397e+00 1.30671233e+02 3.15219178e+02
 2.72616438e+02 1.49013699e+02 5.71027397e+02 6.09493151e+02
 5.64383562e+01 5.47534247e+01 1.72917808e+02 3.30410959e+02
 1.06410959e+02 5.84383562e+01 3.55205479e+01 0.00000000e+00
 4.57808219e+01 8.22876712e+01 8.43520548e+02 1.01191781e+02
 3.02602740e+01 9.55479452e+01 9.95342466e+01 3.04246575e+01
 6.69315068e+01 0.00000000e+00 2.37671233e+01 0.00000000e+00
 2.17671233e+01 2.03013699e+01 1.43150685e+01 1.40273973e+01
 2.40273973e+01 3.40273973e+01 5.25205479e+01 1.10136986e+01
 7.90273973e+01 7.50684932e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 1.08095890e+02 1.73328767e+02 5.13561644e+01 1.21506849e+02
 3.50821918e+01 0.00000000e+00 0.00000000e+00 7.17808219e+01
 8.70000000e+01 6.63698630e+01 1.28219178e+01 6.10958904e+00
 0.00000000e+00 0.00000000e+00 2.34571370e+04 2.31917808e+01
 9.67123288e+00 6.70958904e+01 3.20821918e+01 4.65616438e+01
 2.52054795e+00 9.00684932e+01 9.65068493e+01 5.40273973e+01
 1.32328767e+02 7.42191781e+01 5.56575342e+01 5.31643836e+01
 2.51506849e+01 2.97013699e+02 7.05479452e+00 2.09589041e+00
 0.00000000e+00 6.13424658e+01 0.00000000e+00 0.00000000e+00
 0.00000000e+00 1.17575342e+02 2.47260274e+01 3.07671233e+01
 2.32465753e+01 1.38356164e+00 4.84931507e+00 1.86575342e+01
 1.04520548e+01 5.56164384e+00 3.55342466e+01 8.12328767e+00
 0.00000000e+00 0.00000000e+00 2.56164384e+00 0.00000000e+00
 0.00000000e+00 2.15068493e+00 0.00000000e+00 0.00000000e+00
 1.17260274e+01 7.95890411e+01 4.87506849e+02 0.00000000e+00
 0.00000000e+00 0.00000000e+00 4.18219178e+01 1.04109589e+00
 2.07260274e+01 0.00000000e+00 1.03013699e+02 2.65205479e+01
 2.10273973e+01 3.10136986e+01 8.04109589e+00 4.35205479e+01
 1.00410959e+01 2.50136986e+01 3.95068493e+01 2.05479452e+00
 2.08219178e+00 1.40273973e+01 2.65068493e+01 9.50684932e+00
 7.78082192e+00 4.09589041e+00 1.45068493e+01 8.52054795e+00
 2.15205479e+01 2.04109589e+00 5.06849315e-01 5.06849315e-01
 3.05890411e+01 3.95342466e+01 0.00000000e+00 0.00000000e+00
 1.45068493e+01 7.04109589e+00 0.00000000e+00 1.50684932e+00
 2.11917808e+01 3.96164384e+01 1.66506849e+02 1.17013699e+02
 2.05479452e+00 6.01369863e+00 1.96438356e+01 1.62534247e+02
 0.00000000e+00 1.30136986e+01 1.30958904e+01 4.71232877e+01
 9.61643836e+00 3.95342466e+01 1.37260274e+01 5.20547945e+00
 6.25205479e+01 9.10136986e+01 3.52054795e+00 7.51917808e+01
 1.12328767e+00 0.00000000e+00 4.01369863e+00 8.45890411e+01
 0.00000000e+00 0.00000000e+00 0.00000000e+00 5.89041096e-01
 1.90684932e+01 8.56164384e+00 1.16027397e+01 3.98630137e+00
 3.15205479e+01 0.00000000e+00 5.89041096e-01 5.20547945e-01
 3.10958904e+01 3.73150685e+01 8.50684932e+00 0.00000000e+00
 0.00000000e+00 8.80547945e+01 6.70136986e+01 4.60821918e+01
 1.11013699e+02 0.00000000e+00 3.92720548e+03 1.04534247e+02
 1.00684932e+01 2.75479452e+01 1.75068493e+01 2.95205479e+01
 5.75068493e+01 1.45013699e+02 8.56438356e+01 1.99041096e+01
 3.81561644e+02 0.00000000e+00 4.52054795e+00 0.00000000e+00
 0.00000000e+00 7.03150685e+01 4.75342466e+01 0.00000000e+00
 3.53698630e+01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 3.71232877e+00 0.00000000e+00 1.90136986e+01
 0.00000000e+00 3.00547945e+01 3.60958904e+01 9.09589041e+00
 2.16849315e+01 1.15616438e+01 2.10410959e+01 1.67123288e+00
 0.00000000e+00 0.00000000e+00 5.47945205e-01 1.50684932e+00
 3.50684932e+00 0.00000000e+00 3.57712329e+02 4.10273973e+01
 0.00000000e+00 1.19041096e+01 5.89041096e-01 5.70136986e+01
 5.02739726e+00 3.50684932e+00 1.52054795e+00 3.50684932e+00
 9.63013699e+00 2.02191781e+01 3.55342466e+01 2.73561644e+01
 4.35205479e+01 0.00000000e+00 0.00000000e+00 1.36986301e-02
 0.00000000e+00 0.00000000e+00 7.06438356e+01 2.80136986e+01
 2.50136986e+01 6.38890411e+02 4.93013699e+01 0.00000000e+00
 2.06849315e+00 1.55068493e+01 0.00000000e+00 4.10958904e-02
 5.06849315e-01 0.00000000e+00 8.08219178e+00 1.95205479e+01
 2.26808219e+02 0.00000000e+00 2.01369863e+00 1.00027397e+02
 1.69534247e+02 1.51013699e+02 3.85068493e+01 4.25479452e+01
 1.05068493e+01 3.75068493e+01 3.20136986e+01 3.80547945e+01
 1.05479452e+01 2.35068493e+01 5.35068493e+01 3.70136986e+01
 5.15068493e+01 5.55068493e+01 2.65068493e+01 4.20136986e+01
 4.60273973e+00 9.09589041e+00 5.20547945e+01 5.45342466e+01
 0.00000000e+00 1.75205479e+01 6.10273973e+01 5.91095890e+01
 1.54109589e+01 1.00410959e+01 1.45342466e+01 4.06027397e+01
 3.95068493e+01 4.05205479e+01 1.70136986e+01 0.00000000e+00
 1.36986301e-02 3.10273973e+01 7.05479452e+00 7.65342466e+01
 7.16438356e+00 2.43972603e+02 4.15890411e+01 0.00000000e+00
 6.71232877e+00 6.45342466e+01 3.96712329e+01 3.10027397e+02
 1.63013699e+02 2.35890411e+01 1.65342466e+01 0.00000000e+00
 2.35479452e+01 2.02739726e+00 2.00410959e+01 4.90410959e+01
 9.04109589e+00 4.00410959e+01 0.00000000e+00 3.65342466e+01
 4.00410959e+01 5.65479452e+01 0.00000000e+00 0.00000000e+00
 3.20958904e+01 9.60136986e+01 5.05479452e+01 0.00000000e+00
 2.81095890e+01 9.65890411e+01 0.00000000e+00 7.02739726e+00
 4.56164384e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 4.02739726e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 1.25342466e+01 6.05479452e+00 2.50684932e+00 2.43287671e+01
 0.00000000e+00 4.24246575e+01 0.00000000e+00 0.00000000e+00
 4.32465753e+01 2.07534247e+01 0.00000000e+00 0.00000000e+00
 0.00000000e+00 6.90273973e+01 0.00000000e+00 1.01369863e+00
 3.85205479e+01 1.51602740e+02 7.95342466e+01 9.20136986e+01
 9.45068493e+01 1.10410959e+01 1.05753425e+01 1.80273973e+01
 3.35068493e+01 2.10136986e+01 1.21068493e+02 7.85753425e+01
 2.10684932e+01 1.52739726e+01 1.34506849e+02 6.01369863e+00
 8.60547945e+01 1.47123288e+02 7.70958904e+01 3.52506849e+02
 1.15986301e+02 3.65753425e+01 9.81369863e+01 4.10136986e+01
 3.80273973e+01 1.74534247e+02 3.48273973e+02 1.75068493e+01
 4.56164384e+00 1.02095890e+02 5.65753425e+00 1.11506849e+01
 2.40821918e+01 1.80821918e+00 1.11232877e+01 9.02739726e+00
 4.02739726e+00 0.00000000e+00 5.02739726e+00 7.52054795e+00
 3.50684932e+00 7.02739726e+00 0.00000000e+00 6.52054795e+00
 1.25342466e+01 0.00000000e+00 0.00000000e+00 2.33972603e+01
 0.00000000e+00 2.57260274e+01 6.25342466e+01 0.00000000e+00
 1.51972603e+02 2.22191781e+01 6.02739726e+00 1.55479452e+01
 0.00000000e+00 3.68493151e+01 2.16438356e+01 0.00000000e+00
 0.00000000e+00 0.00000000e+00 3.57534247e+00 9.42328767e+01
 0.00000000e+00 4.50684932e+00 0.00000000e+00 0.00000000e+00
 4.02739726e+00 4.25068493e+01 9.58904110e+00 4.65753425e+00
 1.65068493e+01 9.53424658e+00 1.15616438e+01 2.55342466e+01
 2.87671233e+01 1.71506849e+01 7.16438356e+00 1.04109589e+00
 9.15342466e+01 0.00000000e+00 6.57534247e+00 4.17808219e+00
 3.50684932e+00 0.00000000e+00 1.39726027e+00 3.95205479e+01
 5.16575342e+01 3.45205479e+01 0.00000000e+00 1.66575342e+01
 1.36301370e+01 0.00000000e+00 1.53424658e+00 8.50684932e+00
 2.15068493e+01 1.85068493e+01 2.26301370e+01 1.02506849e+02
 0.00000000e+00 1.05342466e+01 7.53424658e+00 8.02739726e+00
 6.06849315e+00 2.25068493e+01 8.21917808e-02 5.20547945e-01
 0.00000000e+00 2.42123288e+02 2.75616438e+01 1.45068493e+01
 0.00000000e+00 2.73972603e-02 0.00000000e+00 1.10410959e+01
 1.02506849e+02 2.64931507e+01 1.96849315e+01 1.17671233e+01
 5.55890411e+01 2.65479452e+01 8.50684932e+00 0.00000000e+00
 0.00000000e+00 3.32054795e+01 0.00000000e+00 0.00000000e+00
 5.48630137e+01 3.45068493e+01 8.20410959e+01 4.25068493e+01
 1.45068493e+01 2.15068493e+01 3.26027397e+01 9.54794521e+00
 1.60273973e+01 1.70136986e+01 1.15616438e+01 0.00000000e+00
 8.63150685e+01 0.00000000e+00 0.00000000e+00 3.50684932e+00
 2.15616438e+01 8.47260274e+01 8.25342466e+01 0.00000000e+00
 0.00000000e+00 9.50684932e+00 0.00000000e+00 2.01369863e+00
 1.50684932e+00 1.52054795e+00 2.49289205e+05 6.29328767e+04
 7.18767123e+01 6.92328767e+01 1.56164384e+01 2.54794521e+00
 5.07506849e+02 3.02739726e+00 6.02739726e+00 6.52054795e+00
 6.53424658e+00 7.52054795e+00 7.52054795e+00 9.75616438e+01
 7.48493151e+01 6.69863014e+00 2.03506849e+02 2.51506849e+01
 4.38767123e+02 5.50684932e+00 4.55616438e+01 1.75342466e+01
 3.79178082e+01 4.52054795e+00 3.75342466e+01 0.00000000e+00
 8.76712329e+00 0.00000000e+00 8.68493151e+00 1.05890411e+01
 1.20821918e+01 4.75753425e+01 1.70410959e+01 4.76041096e+02
 6.64082192e+02 4.54493151e+02 6.70136986e+01 0.00000000e+00
 4.38356164e+00 0.00000000e+00 1.17808219e+00 3.45890411e+01
 1.04109589e+00 0.00000000e+00 4.25958904e+02 0.00000000e+00
 1.49739726e+02 9.15205479e+01 0.00000000e+00 9.25342466e+01
 6.71506849e+01 9.80136986e+01 0.00000000e+00 1.52054795e+00
 1.05342466e+01 0.00000000e+00 2.00273973e+01 1.65068493e+01
 2.76849315e+01 7.97671233e+01 1.68356164e+01 1.52054795e+00
 1.69983562e+03 8.55794521e+02 4.75205479e+01 2.54520548e+02
 1.05205479e+02 9.55205479e+01 0.00000000e+00 0.00000000e+00
 0.00000000e+00 4.75205479e+01 0.00000000e+00 3.85342466e+01
 1.96986301e+01 1.65205479e+01 2.35753425e+01 0.00000000e+00
 0.00000000e+00 0.00000000e+00 2.90273973e+02 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 3.45342466e+01 4.25068493e+01 5.06849315e+00 1.88547945e+02
 6.36712329e+01 6.20410959e+01 0.00000000e+00 5.35753425e+01
 2.05068493e+01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.71232877e+00 0.00000000e+00 0.00000000e+00 2.54906849e+03
 8.50684932e+00 4.06849315e+00 0.00000000e+00 3.50684932e+00
 0.00000000e+00 9.46438356e+01 1.15479452e+02 1.69863014e+00
 1.54657534e+02 0.00000000e+00 1.20547945e+00 1.18383562e+02
 6.20136986e+01 9.82328767e+01 3.60273973e+01 4.13561644e+01
 9.57671233e+01 5.05753425e+01 0.00000000e+00 5.06849315e-01
 1.01369863e+00 5.47123288e+01 3.02191781e+01 1.80136986e+01
 0.00000000e+00 7.20547945e+00 2.06849315e+00 0.00000000e+00
 1.09589041e+00 5.30273973e+01 0.00000000e+00 0.00000000e+00
 3.47671233e+01 6.52054795e+00 4.45342466e+01 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 3.65479452e+01
 1.30684932e+01 3.30684932e+01 1.00835616e+02 3.48493151e+01
 3.13424658e+01 1.46164384e+01 1.15753425e+01 5.50684932e+00
 2.07013699e+02 1.77027397e+02 2.05342466e+01 1.06506849e+02
 8.96301370e+01 2.35479452e+01 2.40684932e+01 0.00000000e+00
 8.52054795e+00 1.26027397e+01 1.03013699e+02 7.31917808e+01
 2.39589041e+01 1.49219178e+02 6.13698630e+00 0.00000000e+00
 2.20273973e+01 1.90136986e+01 1.45753425e+01 2.05068493e+01
 1.48506849e+02 1.85616438e+01 9.58904110e-02 2.46328767e+03
 1.02393699e+04 2.07904110e+02 0.00000000e+00 1.34616438e+02
 1.76698630e+02 0.00000000e+00 9.18493151e+01 0.00000000e+00
 0.00000000e+00 1.50123288e+02 0.00000000e+00 0.00000000e+00
 9.53424658e+00 0.00000000e+00 0.00000000e+00 6.28767123e+00
 4.02739726e+00 0.00000000e+00 5.47945205e-02 5.31232877e+01
 7.76575342e+01 4.15890411e+01 9.01369863e+00 1.05479452e+00
 1.52054795e+00 1.35068493e+01 1.35068493e+01 1.65890411e+01
 5.60273973e+00 7.01369863e+00 1.22465753e+02 1.72369863e+02
 1.05068493e+01 2.86712329e+01 8.46575342e+00 1.10506849e+02
 8.32465753e+01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 2.60273973e+00 0.00000000e+00 0.00000000e+00 6.31506849e+00
 2.15205479e+01 6.64123288e+02 3.60273973e+00 0.00000000e+00
 1.17072603e+03 3.65616438e+01 3.05753425e+01 5.68561644e+02
 2.00410959e+01 0.00000000e+00 0.00000000e+00 1.50273973e+01
 1.90136986e+01 2.52054795e+00 2.96986301e+01 5.20547945e-01
 0.00000000e+00 0.00000000e+00 3.02739726e+00 0.00000000e+00
 7.05479452e+00 2.12328767e+00 0.00000000e+00 1.30410959e+01
 0.00000000e+00 4.01369863e+00 3.01369863e+00 3.52054795e+00
 7.52054795e+00 6.52054795e+00 1.86575342e+01 1.52054795e+00
 1.00136986e+01 0.00000000e+00 1.22520548e+02 2.01369863e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 2.68502740e+03 0.00000000e+00 0.00000000e+00
 5.40410959e+01 1.66273973e+02 4.38082192e+01 1.09931507e+02
 0.00000000e+00 7.36986301e+01 1.59917808e+03 0.00000000e+00
 0.00000000e+00 1.72561644e+02 9.08767123e+01 1.10958904e+01
 1.25890411e+01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 4.35383562e+02 2.00136986e+01 1.26438356e+01 6.72602740e+00
 0.00000000e+00 1.85068493e+01 2.22739726e+01 0.00000000e+00
 9.16438356e+00 8.58904110e+00 2.69863014e+01 1.50410959e+01
 2.02739726e+00 0.00000000e+00 8.52054795e+00 0.00000000e+00
 1.36986301e-02 3.01369863e+00 0.00000000e+00 0.00000000e+00
 2.35479452e+01 4.01369863e+00 6.02739726e+00 0.00000000e+00
 0.00000000e+00 6.53424658e+00 0.00000000e+00 0.00000000e+00
 6.20273973e+01 1.05479452e+00 1.86561644e+02 1.07315068e+02
 0.00000000e+00 2.01369863e+00 1.95890411e+01 1.41917808e+01
 3.05479452e+00 5.06849315e-01 1.30684932e+01 1.10410959e+01
 3.47260274e+01 0.00000000e+00 2.45342466e+01 6.05479452e+00
 5.34246575e-01 2.37260274e+01 7.04109589e+00 0.00000000e+00
 3.79452055e+00 0.00000000e+00 3.62054795e+01 6.57534247e+00
 2.03054795e+02 2.52054795e+00 2.40410959e+01 1.42739726e+01
 0.00000000e+00 1.53424658e+00 1.52054795e+00 0.00000000e+00
 1.10410959e+01 2.45616438e+01]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  df.loc[medium_mask, 'medium_scrap_qty'] = df.loc[medium_mask].apply(
C:\Users\603506\Desktop\Trevor_Python\POP_Supply_Chain\pages\inventory_page.py:434: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value '[2.15342466e+01 4.10958904e-02 1.11000000e+02 ... 2.06334405e+01
 3.44414791e+02 2.16430868e+01]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  df.loc[aggressive_mask, 'aggressive_scrap_qty'] = df.loc[aggressive_mask].apply(
================================================================================
WAREHOUSE SCRAP LIST EXPORT DIAGNOSTIC TEST
================================================================================

[STEP 1] Loading data...
âœ“ Data loaded successfully
  - Data keys: ['master', 'service', 'backorder', 'inventory', 'inventory_analysis', 'load_time', 'load_time_str', 'master_logs', 'orders_logs', 'orders_item_logs', 'orders_header_logs', 'deliveries_logs', 'service_logs', 'backorder_logs', 'inventory_logs', 'analysis_logs', 'master_errors', 'service_errors', 'backorder_errors', 'inventory_errors', 'master_df', 'service_df', 'backorder_df', 'inventory_df', 'inventory_analysis_df']

[STEP 2] Checking inventory_analysis data...
âœ“ inventory_analysis found
  - Shape: (2082, 17)
  - Columns: ['sku', 'on_hand_qty', 'in_transit_qty', 'last_purchase_price', 'currency', 'daily_demand', 'q1_demand', 'q2_demand', 'q3_demand', 'q4_demand']... (17 total)
âœ“ All required columns present
  - Total SKUs: 2082
  - SKUs with inventory (on_hand_qty > 0): 1976

[STEP 3] Checking activation_date column...
âœ“ 'activation_date' column found
  - Data type: datetime
  - Valid dates: 2064/2082
  - Date range: 2000-01-01 00:00:00 to 2025-08-04 00:00:00
  - SKUs > 1 year old: 1767
  - SKUs > 2 years old: 1457
  - SKUs > 3 years old: 1197

[STEP 4] Checking monthly demand columns (last 12 months)...
âœ“ Found monthly columns: ['m_YYYY_MM', 'm_YYYY_MM', 'm_YYYY_MM', '...']

[STEP 5] Testing prepare_warehouse_scrap_list() function...
âœ“ Function executed successfully
  - Result shape: (1976, 28)
  - Result columns: ['Material', 'Alternate Codes', 'Storage Location', 'Description', 'SKU Creation Date', 'Flag Status (PLM Current Status)', 'Last Inbound Date', 'PLM Expiration Date', 'Brand', 'Category', 'STD Price', 'Total STD Price', 'Free Qt', '... (last 12 monthly demand cols) ...', 'Rolling 1 Yr Usage', '# of Months with History', 'Months of Supply', 'Qty over 2 Yrs Supply', 'USD value over 2 Yrs Supply', 'Conservative Scrap Qty', 'Conservative Scrap Value (USD)', 'Medium Scrap Qty', 'Medium Scrap Value (USD)', 'Aggressive Scrap Qty', 'Aggressive Scrap Value (USD)']
âœ“ Scrap list generated with 1976 rows
  âœ“ All 6 scrap recommendation columns present
    - Conservative Scrap Qty: 699 non-zero values
    - Conservative Scrap Value (USD): 542 non-zero values
    - Medium Scrap Qty: 1320 non-zero values
    - Medium Scrap Value (USD): 1118 non-zero values
    - Aggressive Scrap Qty: 1604 non-zero values
    - Aggressive Scrap Value (USD): 1389 non-zero values

[STEP 6] Sample results:

First 3 rows:
            Material Alternate Codes Storage Location Description SKU Creation Date Flag Status (PLM Current Status) Last Inbound Date PLM Expiration Date Brand              Category  STD Price  Total STD Price  Free Qt  Q1 Demand  Q2 Demand  Q3 Demand  Q4 Demand  Rolling 1 Yr Usage  # of Qtrs with History  Months of Supply  Qty over 2 Yrs Supply  USD value over 2 Yrs Supply  Conservative Scrap Qty  Conservative Scrap Value (USD)  Medium Scrap Qty  Medium Scrap Value (USD)  Aggressive Scrap Qty  Aggressive Scrap Value (USD)
1532  ZOVTW25 DI0001  ZOVTW25 DI0001                                     2025-02-14                        COMPLETED                            2050-12-31           WHLS PERMANENT TW    1800.00        199800.00      111        0.0        0.0        0.0        2.0                10.0                       2         81.400000              77.818182                155636.363636                     0.0                             0.0               0.0                       0.0              0.000000                      0.000000
890   ZEYSP24 SP0001  ZEYSP24 SP0001                                     2024-10-04                        COMPLETED                            2029-12-31                     ESSILOR      27.10        108400.00     4000        0.0        0.0        0.0        0.0               250.0                       1        188.266667            3483.002833                 94389.376771                     0.0                             0.0               0.0                       0.0           3936.260623                 106672.662890
2075  ZXDRI25 RI0004  ZXDRI25 RI0004                                     2024-11-15                        COMPLETED                            2035-01-01        WHLS PERMANENT SMALL     166.24         86112.32      518        0.0        0.0       21.0       15.0                37.0                       3        145.133333             431.151125                 71674.563087                     0.0                             0.0               0.0                       0.0            507.292605                  84332.322572

Column summary:
  STD Price: min=0.0, max=8150.0, mean=96.52
  Total STD Price: min=0.0, max=270002.26, mean=4743.40
  Free Qt: min=1, max=418144, mean=485.79
  Monthly Demand (sample): min=0.0, max=159000.0, mean=<varies per-month>
  Rolling 1 Yr Usage: min=0.0, max=342400.0, mean=507.01
  # of Months with History: min=0, max=12, mean=4.39
  Months of Supply: min=0.0, max=6180.666666666667, mean=62.53
  Qty over 2 Yrs Supply: min=0.0, max=65486.0, mean=119.15
  USD value over 2 Yrs Supply: min=0.0, max=155636.36363636362, mean=1707.65
  Conservative Scrap Qty: min=0.0, max=2057.0, mean=20.47
  Conservative Scrap Value (USD): min=0.0, max=61966.66666666667, mean=668.24
  Medium Scrap Qty: min=0.0, max=249289.20547945204, mean=222.51
  Medium Scrap Value (USD): min=0.0, max=62028.614916286155, mean=1775.49
  Aggressive Scrap Qty: min=0.0, max=361859.0684931507, mean=331.82
  Aggressive Scrap Value (USD): min=0.0, max=109736.30136986302, mean=3124.39

================================================================================
TEST COMPLETED
================================================================================
